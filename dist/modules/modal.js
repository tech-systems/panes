/**
 * Cupertino Pane 1.5.0
 * Cupertino Panes is multi-functional modals, cards & panes with touch technologies.
 * https://panejs.com
 *
 * Copyright 2019-2025 Roman Antonov (roman-rr)
 *
 * Released under the MIT License
 *
 * Released on: August 21, 2025
 */

class ModalModule{static CollectSettings(t){return t.modal?Object.assign(Object.assign({},t),ModalModule.ForceSettings):t}constructor(t){this.instance=t,this.modalDefaults={transition:"fade",flying:!1,dismissOnIntense:!1},this.settings=this.instance.settings,this.events=this.instance.events,this.breakpoints=this.instance.breakpoints,this.transitions=this.instance.transitions,this.settings.modal&&(this.settings.modal="object"==typeof this.settings.modal?Object.assign(Object.assign({},this.modalDefaults),this.settings.modal):this.modalDefaults,this.instance.customPresent=this.instance.present,this.instance.present=t=>this.present(t),this.instance.customDestroy=this.instance.destroy,this.instance.destroy=t=>this.destroy(t),this.events.handleSuperposition=t=>this.handleSuperposition(t),this.transitions.setPaneElTransform=t=>this.setPaneElTransform(t),this.instance.on("beforeBreakHeightApplied",(t=>{"top"===t.break&&(this.settings.breaks.top.height-=2*this.settings.bottomOffset,this.settings.breaks.top.height+=(this.instance.screen_height-this.settings.breaks.top.height)/2),"bottom"===t.break&&(this.settings.breaks.bottom={enabled:!1}),this.instance.addStyle(`\n        .cupertino-pane-wrapper .pane {\n          transform-origin: center ${this.breakpoints.breaks[this.settings.initialBreak]}px\n        }\n      `)})),this.instance.on("rendered",(()=>{this.instance.addStyle("\n        .cupertino-pane-wrapper .pane {\n          border-radius: var(--cupertino-pane-border-radius, 20px) \n                         var(--cupertino-pane-border-radius, 20px)\n                         var(--cupertino-pane-border-radius, 20px)\n                         var(--cupertino-pane-border-radius, 20px);\n          width: calc(100% - 16px) !important;\n          margin: auto;\n        }\n        .cupertino-pane-wrapper .pane.modal-flying {\n          animation: modalFlyingX 2000ms ease-in-out infinite alternate,\n                     modalFlyingY 3000ms ease-in-out infinite alternate;\n        }\n        @keyframes modalFlyingX {\n          0% { left: -10px; }\n          100% { left: 10px; }\n        }\n        @keyframes modalFlyingY {\n          0% { top: -10px; }\n          100% { top: 0px; }\n        }\n      "),this.settings.modal.flying&&this.instance.paneEl.classList.add("modal-flying"),this.settings.modal.dismissOnIntense&&this.instance.enableDrag()})))}setPaneElTransform(t){let n,s=t.translateY;n="end"===t.type?0:void 0!==t.translateX?t.translateX:this.instance.getPanelTransformX(),this.instance.currentTranslateX=n,this.instance.currentTranslateY=s,this.instance.paneEl.style.transform=this.instance.buildTransform3d(this.instance.currentTranslateX,this.instance.currentTranslateY,0)}present(t){let{transition:n}=t;return n||(n=ModalModule.BuildInTransition[this.settings.modal.transition]),this.instance.customPresent(Object.assign(Object.assign({},t),{transition:n}))}destroy(t){let{transition:n}=t;if(n||(n=JSON.parse(JSON.stringify({duration:ModalModule.BuildInTransition[this.settings.modal.transition].duration,from:ModalModule.BuildInTransition[this.settings.modal.transition].to,to:ModalModule.BuildInTransition[this.settings.modal.transition].from}))),t.fromCurrentPosition){let t=this.instance.parseTransform3d(this.instance.paneEl);n.to.transform=this.instance.buildTransform3d(t.x,t.y,0)}return this.instance.customDestroy(Object.assign(Object.assign({},t),{transition:n}))}handleSuperposition(t){let n=Math.abs(this.instance.getPanelTransformY()-this.breakpoints.topper),s=Math.abs(this.instance.getPanelTransformX());if(this.settings.modal.dismissOnIntense&&(n>40||s>30))return this.instance.disableDrag(),this.destroy({animate:!0,fromCurrentPosition:!0}),!1;const i=this.instance.getPanelTransformY()/this.breakpoints.topper/8,e=this.instance.getPanelTransformX()/this.breakpoints.topper/8;return{y:this.instance.getPanelTransformY()+t.diffY*(i+e),x:this.instance.getPanelTransformX()+t.diffX*(i+e)}}}ModalModule.BuildInTransition={fade:{duration:300,from:{opacity:0},to:{opacity:1}},zoom:{duration:300,from:{opacity:0,scale:.5},to:{opacity:1,scale:1}}},ModalModule.ForceSettings={fitHeight:!0,touchAngle:null,showDraggable:!1};export{ModalModule};
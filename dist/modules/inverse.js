/**
 * Cupertino Pane 1.5.0
 * Cupertino Panes is multi-functional modals, cards & panes with touch technologies.
 * https://panejs.com
 *
 * Copyright 2019-2025 Roman Antonov (roman-rr)
 *
 * Released under the MIT License
 *
 * Released on: August 21, 2025
 */

function __awaiter(t,e,n,s){return new(n||(n=Promise))((function(i,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))}"function"==typeof SuppressedError&&SuppressedError;class InverseModule{constructor(t){this.instance=t,this.breakpoints=this.instance.breakpoints,this.settings=this.instance.settings,this.events=this.instance.events,this.settings.inverse&&(this.settings.buttonDestroy=!1,this.instance.getPaneHeight=()=>this.getPaneHeight(),this.instance.updateScreenHeights=()=>this.updateScreenHeights(),this.instance.setOverflowHeight=()=>this.settings.fitHeight?{}:this.setOverflowHeight(),this.instance.checkOpacityAttr=()=>{},this.instance.checkOverflowAttr=t=>this.checkOverflowAttr(t),this.instance.prepareBreaksSwipeNextPoint=()=>this.prepareBreaksSwipeNextPoint(),this.instance.swipeNextPoint=(t,e,n)=>this.swipeNextPoint(t,e,n),this.events.fastSwipeNext=t=>this.fastSwipeNext(t),this.events.handleSuperposition=t=>this.handleSuperposition(t),this.events.scrollPreventDrag=t=>this.scrollPreventDrag(t),this.events.onScroll=()=>this.onScroll(),this.instance.transitions.setPaneElTransform=t=>this.setPaneElTransform(t),this.instance.currentTranslateX=0,this.instance.on("DOMElementsReady",(()=>{this.instance.wrapperEl.classList.add("inverse")})),this.instance.on("rendered",(()=>{this.instance.addStyle("\n        .cupertino-pane-wrapper.inverse .pane {\n          border-radius: 0 0 20px 20px;\n          border-radius: 0 0\n                        var(--cupertino-pane-border-radius, 20px) \n                        var(--cupertino-pane-border-radius, 20px);\n        }\n        .cupertino-pane-wrapper.inverse:not(.fit-height) .pane {\n          padding-bottom: 15px; \n        }\n        .cupertino-pane-wrapper.inverse .draggable {\n          bottom: 0;\n          top: initial;\n        }\n        .cupertino-pane-wrapper.inverse .draggable.over {\n          bottom: -30px;\n          top: initial;\n        }\n        .cupertino-pane-wrapper.inverse .move {\n          margin-top: 15px;\n        }\n        .cupertino-pane-wrapper.inverse .draggable.over .move {\n          margin-top: -5px;\n        }\n      ")})),this.instance.on("buildBreakpointsCompleted",(()=>{const t=Object.assign({},this.breakpoints.breaks),e=this.instance.screen_height;["top","middle","bottom"].forEach((n=>{var s;if(void 0!==t[n]&&(null===(s=this.settings.breaks[n])||void 0===s?void 0:s.enabled)){const t=this.settings.breaks[n].height,s=e-t-this.settings.bottomOffset;this.breakpoints.breaks[n]=s}}));const n=Object.values(this.breakpoints.breaks).filter((t=>"number"==typeof t)),s=Math.min(...n),i=Math.max(...n);this.breakpoints.topper=s,this.breakpoints.bottomer=i,this.breakpoints.brs=n,this.instance.paneEl.style.top=`-${Math.abs(this.breakpoints.bottomer)-this.settings.bottomOffset}px`})),this.instance.on("onWillPresent",(()=>{this.breakpoints.beforeBuildBreakpoints=()=>this.beforeBuildBreakpoints()})))}getPaneHeight(){return this.breakpoints.bottomer-this.settings.bottomOffset}updateScreenHeights(){this.instance.screen_height=window.innerHeight,this.instance.screenHeightOffset=0}setOverflowHeight(){this.instance.overflowEl.style.height=this.getPaneHeight()-30-this.settings.topperOverflowOffset-this.instance.overflowEl.offsetTop+"px"}checkOverflowAttr(t){this.settings.topperOverflow&&this.instance.overflowEl&&(this.instance.overflowEl.style.overflowY=t>=this.breakpoints.bottomer?"auto":"hidden")}prepareBreaksSwipeNextPoint(){return{brs:Object.assign({},this.breakpoints.breaks),settingsBreaks:Object.assign({},this.settings.breaks)}}handleSuperposition(t){if(t.newVal<=this.breakpoints.topper)return{y:this.breakpoints.topper};if(t.newVal>=this.breakpoints.bottomer)return{y:this.breakpoints.bottomer};if(t.newVal<=this.breakpoints.topper){if(this.settings.upperThanTop){this.events.startPointOverTop||(this.events.startPointOverTop=t.clientY),this.events.startPointOverTop>t.clientY&&delete this.events.startPointOverTop;const e=this.instance.screen_height-this.instance.screenHeightOffset,n=(e-Math.abs(this.instance.getPanelTransformY()))/(e-Math.abs(this.breakpoints.topper))/8;return{y:this.instance.getPanelTransformY()+t.diffY*n}}return{y:this.breakpoints.topper}}}scrollPreventDrag(t){let e=!1;return this.events.willScrolled()&&this.isOverflowEl(t.target)&&(e=!0),e}isOverflowEl(t){if(!t)return!1;let e=t.parentNode;for(;null!=e;){if(e==this.instance.overflowEl)return!0;e=e.parentNode}return!1}onScroll(){return __awaiter(this,void 0,void 0,(function*(){this.events.isScrolling=!0}))}setPaneElTransform(t){this.instance.currentTranslateY=t.translateY,this.instance.currentTranslateX=0;const e=this.instance.buildTransform3d(0,this.instance.currentTranslateY,0);this.instance.paneEl.style.transform=e}fastSwipeNext(t){var e,n;if(this.events.allowClick)return!1;if(this.events.steps.length<2)return!1;const s=this.events.steps[this.events.steps.length-1],i=this.events.steps[this.events.steps.length-2],r=(null!==(e=null==s?void 0:s["pos"+t])&&void 0!==e?e:0)-(null!==(n=null==i?void 0:i["pos"+t])&&void 0!==n?n:0);return!!Number.isFinite(r)&&Math.abs(r)>=this.events.swipeNextSensivity}swipeNextPoint(t,e,n){var s,i,r,o,a,h;const p=this.breakpoints.breaks,l=this.settings.breaks,c=this.instance.breakpoints.currentBreakpoint,v=p.top,u=p.middle,d=p.bottom;if(c===v){if(t>e){if(null===(s=l.middle)||void 0===s?void 0:s.enabled)return u;if(null===(i=l.bottom)||void 0===i?void 0:i.enabled)return d}return v}if(c===u)return t<-e&&(null===(r=l.top)||void 0===r?void 0:r.enabled)?v:t>e&&(null===(o=l.bottom)||void 0===o?void 0:o.enabled)?d:u;if(c===d){if(t<-e){if(null===(a=l.middle)||void 0===a?void 0:a.enabled)return u;if(null===(h=l.top)||void 0===h?void 0:h.enabled)return v}return d}return n}beforeBuildBreakpoints(){}}export{InverseModule};